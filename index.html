<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Fish CSS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="style.css" />
    <link rel="icon" href="img/favicon.png" type="image/x-icon"/>
</head>
<body>

    <div class="sail"></div>

    <div class="reflect-small" style="left:20%;width:15%;" ></div>
    <div class="reflect"></div>
    <div class="reflect-small"></div>

    <div class="container" >

      <!-- FISH -->
      <div class="fish" >

        <div class="bubles">
          <div class="buble"></div>
          <div class="buble buble-small"></div>
          <div class="buble-big"></div>
        </div>

        <div class="belly">

          <div class="cheeck"></div>

          <div class="eye">
              <div class="pupill"></div>
          </div>

          <div class="mouth">
            <div class="lips"></div>
          </div>

          <div class="flipper"></div>

        </div>

        <div class="tail">
          <div class="tail-top"></div>
          <div class="tail-bottom"></div>
        </div>

      </div>
      <!-- End FISH -->

      <div class="worm">
        <div class="worm-body"></div>
        <div class="worm-body"></div>
        <div class="worm-body"></div>
        <div class="worm-body"></div>
        <div class="worm-body"></div>
      </div>


    </div>

    <script >


      // --------------------------------------------
      // Animate with animation request
      function animate({duration, draw, timing}) {

        let start = performance.now();

        requestAnimationFrame(function animate(time) {
          let timeFraction = (time - start) / duration;
          if (timeFraction > 1) timeFraction = 1;

          let progress = timing(timeFraction)

          draw(progress);

          if (timeFraction < 1) {
            requestAnimationFrame(animate);
          }

        });
        }
      // --------------------------------------------

      let cheek    = document.querySelector('.worm');

      cheek.onclick = function() {
        console.log('kiko');
      animate({
        duration: 1000,
        timing: function(timeFraction) {
          return timeFraction;
        },
        draw: function(progress) {
          cheek.style.width = progress * 100 + '%';
        }
      });
    };


      // --------------------------------------------
      // Draw
      function draw(elmt, progress) {
        elmt.style.left = progress + 'px';
      }
      // --------------------------------------------

      function circ(timeFraction) {
        return 1 - Math.sin(Math.acos(timeFraction));
      }


      // --------------------------------------------
      // Get objects
      let eyeFish = document.querySelector('.pupill');
      let wrom    = document.querySelector('.worm');
      // --------------------------------------------


      // --------------------------------------------
      // On mouse move event
      window.onmousemove = function (e) {
          
          // --------------------------------------------
          // Init vars
          var x = e.clientX;
              y = e.clientY;
              eyeFish.style.top  = (y/30) + '%';
              eyeFish.style.left = (x/30) + '%';
          // --------------------------------------------


          // --------------------------------------------
          // Set objects
          wrom.style.transform = "translate("+x+"px, "+y+"px)";                            
          let wromBody = wrom.children;
          // --------------------------------------------


          // --------------------------------------------
          // Animate childrens folowing effect
              for (i = 0; i < wromBody.length; i++) {
                
                wromBody[i].style.top = i*(y/30) + '%';
                // console.log(20*i-wrom.style.left);

                // --------------------------------------------
                // Launch animate function
                /*animate({
                  duration: 1000,
                  timing: function(timeFraction) {
                    return timeFraction;
                  },
                  draw: function(progress) {
                    wromBody[i].style.width = progress * 100 + '%';
                  }
                });*/
                // --------------------------------------------        

                //wromBody[i].style.transform = "translate("+(x/30)+"%, "+(y/30)+"%)";
              }
          // --------------------------------------------

      };
      // --------------------------------------------
    </script>

</body>
</html>